#
# Makefile for XDIFile C library
#
#
AR = ar
CC = @CC@
CPP = @CPP@
MAKEINFO = @MAKEINFO@
PACKAGE = @PACKAGE@
RANLIB = @RANLIB@
SHELL = @SHELL@
LINK = @CC@
srcdir = @srcdir@
prefix = @prefix@
exec_prefix = @exec_prefix@
LDFLAGS = @LDFLAGS@
bindir = @bindir@
libdir = @libdir@

# you shouldn't have to alter anything below this line
#---------------------------------
EXAMPLE1  = xdi_example1
LIBXDIF   = libxdifile.a
LIBSHARED = libxdifile.so
XDIF_OBJ  = xdifile.o strutil.o

LINKXDIF = -L$(libdir) -L. -lxdifile

all: $(EXAMPLE1)  $(LIBSHARED)

$(EXAMPLE1).o: $(EXAMPLE1).c

.PHONY: clean install default

default: $(EXAMPLE1)

strutil.o: strutil.h
xdifile.o: xdifile.h xdi_tokens.h strutil.h

$(LIBXDIF): $(XDIF_OBJ)
	@rm -f $@
	$(AR) cru $(LIBXDIF) $(XDIF_OBJ)
	$(RANLIB) $(LIBXDIF)

$(LIBSHARED): $(XDIF_OBJ)
	@rm -f $@
	$(LINK) -shared -o $@ $(XDIF_OBJ)

$(EXAMPLE1): $(LIBSHARED) $(EXAMPLE1).o
	$(LINK) -o $(EXAMPLE1)  $(EXAMPLE1).o $(LIBSHARED)
###	$(LINK) -o $(EXAMPLE1)  $(EXAMPLE1).o $(LINKXDIF)

clean :
	rm -f $(XDIF_OBJ) $(EXAMPLE1).o $(EXAMPLE1) $(LIBXDIF)

install: $(LIBXDIF)
	cp -pr $(LIBXDIF) $(libdir)/$(LIBXDIF)
